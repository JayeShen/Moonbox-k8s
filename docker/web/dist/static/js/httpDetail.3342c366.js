(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["httpDetail"],{"21b7":function(e,t,a){},"28ae":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("v-http-flow",{key:e.traceId,attrs:{traceId:e.traceId,taskRunId:e.taskRunId,closeType:1}})],1)},s=[],o=a("f94c"),l={components:{vHttpFlow:o["a"]},data:function(){return{traceId:this.$route.params.traceId,taskRunId:this.$route.params.taskRunId}}},i=l,n=(a("4fdc"),a("e607")),c=Object(n["a"])(i,r,s,!1,null,"35d6ed4c",null);t["default"]=c.exports},"42a6":function(e,t,a){},"4fdc":function(e,t,a){"use strict";a("21b7")},dd32:function(e,t,a){"use strict";a("42a6")},f94c:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{staticClass:"demo-ruleForm"},[t("el-card",[t("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[t("h3",[t("span",[e._v("基础信息")]),t("div",{staticClass:"forCopy"},[t("el-input",{ref:"forCopyInput",staticClass:"forCopyInput",model:{value:e.curlRequest,callback:function(t){e.curlRequest=t},expression:"curlRequest"}}),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.changeValue}},[e._v("复制为curl命令")])],1)])]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"traceId："}},[e._v("\n            "+e._s(e.traceId)+"\n          ")])],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"协议类型："}},[e._v("\n            "+e._s(e.type)+"\n          ")])],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"采集机器："}},[e._v("\n            "+e._s(e.host)+"\n          ")])],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"流量环境："}},[e._v("\n            "+e._s(e.environment)+"\n          ")])],1)],1)],1),t("el-card",[t("div",{attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("接口信息")])]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"接口uri："}},[e._v("\n            "+e._s(e.uri)+"\n          ")])],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"真实uri："}},[e._v("\n            "+e._s(e.requestURI)+"\n          ")])],1)],1)],1),t("el-card",{staticClass:"requestParams"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("请求参数")])]),t("el-collapse",{class:["lever2",{noBorderBottom:e.paramCollapse.length}],model:{value:e.paramCollapse,callback:function(t){e.paramCollapse=t},expression:"paramCollapse"}},[t("el-collapse-item",{attrs:{name:"1",title:"接口headers"}},[t("el-table",{attrs:{data:e.headersArray,border:"","max-height":"500"}},[t("el-table-column",{attrs:{label:"key",prop:"key",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"value",prop:"value",align:"center","show-overflow-tooltip":""}})],1)],1),e.requestBody?t("el-collapse-item",{attrs:{name:"2",title:"接口body"}},[t("json-viewer",{attrs:{value:e.requestBody,expanded:!0,"expand-depth":5,boxed:"",copyable:"",sort:""}})],1):e._e(),t("el-collapse-item",{attrs:{name:"3",title:"接口params"}},[t("el-table",{attrs:{data:e.paramsArray,border:"","max-height":"500"}},[t("el-table-column",{attrs:{label:"key",prop:"key",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"value",prop:"value",align:"center","show-overflow-tooltip":""}})],1)],1)],1)],1),e.showResponse?t("el-card",[t("el-collapse",{class:["lever1",{noBorderBottom:e.responseCollapse.length}],model:{value:e.responseCollapse,callback:function(t){e.responseCollapse=t},expression:"responseCollapse"}},[t("el-collapse-item",{attrs:{name:"1",title:"响应内容"}},[t("el-form-item",[t("json-viewer",{attrs:{value:e.response,"expand-depth":5,expanded:!0,boxed:"",copyable:"",sort:""}})],1)],1)],1)],1):e._e(),t("el-card",[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("子调用对比结果")])]),t("el-form-item",{staticStyle:{float:"left"}},[t("el-input",{attrs:{size:"small",placeholder:"请输入接口过滤",clearable:""},model:{value:e.inputSearch,callback:function(t){e.inputSearch=t},expression:"inputSearch"}})],1),t("el-table",{attrs:{data:e.filterData,border:"","max-height":"500"}},[t("el-table-column",{attrs:{label:"序号",align:"center",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.$index))])]}}])}),t("el-table-column",{attrs:{label:"子调用类型",prop:"type",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"子调用信息",prop:"uri",align:"center","min-width":"400","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"执行耗时(毫秒)",prop:"cost",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.sonDetail(a.row)}}},[e._v("调用详情")])]}}])})],1)],1)],1),t("el-card",{staticClass:"add-record-bottom-component"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.resetForm()}}},[e._v("关闭")])],1),t("el-dialog",{attrs:{title:"调用详情",visible:e.dialogVisible,width:"1000px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{staticClass:"demo-ruleForm"},[e.otherFlag?t("div",[t("el-card",[t("div",{attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("接口信息")])]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"接口uri："}},[e._v("\n                "+e._s(e.dialogUri)+"\n              ")])],1)],1)],1),t("el-card",[t("div",{attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("请求参数")])]),t("el-form-item",[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-table",{attrs:{data:e.requestParameterArray,border:"","max-height":"500"}},[t("el-table-column",{attrs:{label:"序号",align:"center",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.$index))])]}}],null,!1,3869450744)}),t("el-table-column",{attrs:{label:"参数值",prop:"parameterValue",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"参数类型",prop:"parameterType",align:"center","show-overflow-tooltip":""}})],1)],1)],1)],1)],1),t("el-card",[t("div",{attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("响应内容")])]),t("el-form-item",[t("json-viewer",{attrs:{value:e.dialogResponse,"expand-depth":5,boxed:"",copyable:"",sort:""}})],1)],1),t("el-card",{attrs:{shadow:"hover"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("调用堆栈")])]),e._l(e.stackTraces,(function(a,r){return t("div",{key:r},[e._v("\n            "+e._s(a)+"\n          ")])}))],2)],1):e._e(),e.httpFlag?t("div",[t("el-card",[t("div",{attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("接口信息")])]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"接口uri："}},[e._v("\n                "+e._s(e.dialogUri)+"\n              ")])],1)],1)],1),t("el-card",[t("div",{attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("请求参数")])]),t("el-form-item",[t("h4",[e._v("接口headers")])]),t("el-table",{attrs:{data:e.dialogHeadersArray,border:"","max-height":"500"}},[t("el-table-column",{attrs:{label:"key",prop:"key",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"value",prop:"value",align:"center","show-overflow-tooltip":""}})],1),t("el-form-item",[t("h4",[e._v("接口params")])]),t("el-table",{attrs:{data:e.dialogParamsArray,border:"","max-height":"500"}},[t("el-table-column",{attrs:{label:"key",prop:"key",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"value",prop:"value",align:"center","show-overflow-tooltip":""}})],1)],1),t("el-card",[t("div",{attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("请求body")])]),t("el-form-item",[t("json-viewer",{attrs:{value:e.dialogBody,"expand-depth":5,boxed:"",copyable:"",sort:""}})],1)],1),t("el-card",{attrs:{shadow:"hover"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("响应内容")])]),t("el-form-item",[t("json-viewer",{attrs:{value:e.dialogResponse,"expand-depth":5,boxed:"",copyable:"",sort:""}})],1)],1),t("el-card",{attrs:{shadow:"hover"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("调用堆栈")])]),e._l(e.stackTraces,(function(a,r){return t("div",{key:r},[e._v("\n            "+e._s(a)+"\n          ")])}))],2)],1):e._e()]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1)],1)},s=[],o=(a("fc02"),a("868d")),l=(a("a450"),a("1bc7"),a("32ea"),a("085b"),a("0cdc"),a("f829")),i=(a("4890"),a("6161"),a("365c")),n=a("258b"),c=a.n(n),d={name:"v-http-flow",props:["traceId","taskRunId","closeType"],components:{JsonViewer:c.a},data:function(){return{curlRequest:"",inputSearch:"",dialogVisible:!1,type:"",entranceInvocation:{},uri:"",requestURI:"",port:"",contentType:"",host:"",headers:{},headersArray:[],dialogHeadersArray:[],paramsMap:{},paramsArray:[],requestBody:null,dialogParamsArray:[],response:{},subInvocations:[],environment:"",dialogUri:"",requestParameterArray:[],dialogHeaders:{},dialogParamsMap:{},dialogBody:{},dialogResponse:{},httpFlag:!1,otherFlag:!1,paramCollapse:[],responseCollapse:[]}},computed:{filterData:function(){var e=JSON.parse(JSON.stringify(this.subInvocations));if(this.inputSearch.trim()){var t=this;e=this.subInvocations.filter(function(e){return Object(l["a"])(this,this),-1!==e.uri.indexOf(t.inputSearch.trim())}.bind(this))}return e},showResponse:function(){return Object.keys(this.response).length}},created:function(){this.getDetail()},methods:{resetForm:function(){this.$store.dispatch("page/close",{tagName:this.$route.name,notNext:!0}),1==this.closeType?this.routerPush({name:"record",params:{},query:{}}):2==this.closeType&&this.routerPush({name:"playback",params:{},query:{}})},getDetail:function(){if(""!=this.traceId||""!=this.taskRunId){var e={traceId:this.traceId,taskRunId:this.taskRunId};i["a"].record.flowDetail(e).then(function(e){if(Object(l["a"])(this,this),"SUCCESS"===e.code){if(this.host=e.data.host,this.curlRequest=e.data.curlRequest,this.environment=e.data.environment,this.entranceInvocation=e.data.entranceInvocation,this.type=this.entranceInvocation.type,this.uri=this.entranceInvocation.uri,this.requestURI=this.entranceInvocation.requestURI,this.port=this.entranceInvocation.port,this.contentType=this.entranceInvocation.contentType,this.headers=this.entranceInvocation.headers,"{}"!==JSON.stringify(this.headers))for(var t in this.headers){var a={};a.key=t,a.value=this.headers[t],this.headersArray.push(a)}if(this.paramsMap=this.entranceInvocation.paramsMap,"{}"!==JSON.stringify(this.paramsMap))for(var r in this.paramsMap){var s={};s.key=r,s.value=this.paramsMap[r],this.paramsArray.push(s)}this.entranceInvocation.body&&(this.requestBody=this.entranceInvocation.body),this.entranceInvocation.response&&(this.response=this.entranceInvocation.response),this.subInvocations=e.data.subInvocations}else this.$message.error("获取http详情失败:"+e.msg)}.bind(this))}},sonDetail:function(e){if(this.httpFlag=!1,this.otherFlag=!1,this.dialogVisible=!0,this.dialogResponse={},e.response&&(this.dialogResponse=e.response),this.dialogUri="","http"===e.type.toLowerCase()||"okhttp"===e.type.toLowerCase()||"apache-http-client"===e.type.toLowerCase()){if(this.dialogHeadersArray=[],this.dialogParamsArray=[],this.httpFlag=!0,this.dialogUri=e.uri,this.dialogHeaders=e.headers,"object"==Object(o["a"])(e.body)&&null!=e.body&&(this.dialogBody=e.body),"string"==typeof e.body&&(this.dialogBody=e.body),"{}"!==JSON.stringify(this.dialogHeaders))for(var t in this.dialogHeaders)this.dialogHeadersArray.push({key:t,value:this.dialogHeaders[t]});if(this.dialogParamsMap=e.paramsMap,"{}"!==JSON.stringify(this.dialogParamsMap))for(var a in this.dialogParamsMap)this.dialogParamsArray.push({key:a,value:this.dialogParamsMap[a]})}else if(this.otherFlag=!0,this.requestParameterArray=[],this.dialogUri=e.uri,e.request&&e.request.length)for(var r=0;r<e.request.length;r++)this.requestParameterArray.push({parameterValue:JSON.stringify(e.request[r]),parameterType:e.parameterTypes[r]});this.stackTraces=e.stackTraces.split(/\n/)},changeValue:function(){if(!this.curlRequest)return this.$message.error("复制失败：curlRequest为null");this.$refs.forCopyInput.select(),document.execCommand("copy"),this.$message.success("复制成功")}}},h=d,p=(a("dd32"),a("e607")),u=Object(p["a"])(h,r,s,!1,null,"08a61a45",null);t["a"]=u.exports}}]);