(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["addRecord"],{"1d14":function(t,e,a){"use strict";a("ffbf")},"3f5b":function(t,e,a){var l=Date.prototype,o="Invalid Date",s="toString",i=l[s],r=l.getTime;new Date(NaN)+""!=o&&a("84e8")(l,s,(function(){var t=r.call(this);return t===t?i.call(this):o}))},4057:function(t,e,a){"use strict";a("de49");var l=a("a86f"),o=a("6bf8"),s=a("26df"),i="toString",r=/./[i],n=function(t){a("84e8")(RegExp.prototype,i,t,!0)};a("0926")((function(){return"/a/b"!=r.call({source:"a",flags:"b"})}))?n((function(){var t=l(this);return"/".concat(t.source,"/","flags"in t?t.flags:!s&&t instanceof RegExp?o.call(t):void 0)})):r.name!=i&&n((function(){return r.call(this)}))},8201:function(t,e,a){"use strict";a.r(e);a("a450");var l=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[e("div",[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"160px"}},[e("el-card",[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("h4",[t._v("录制任务基础信息配置")])]),e("div",["add"!=t.type?e("el-form-item",{attrs:{label:"任务编号："}},[t._v("\n            "+t._s(t.templateId)+"\n          ")]):t._e(),e("el-form-item",{attrs:{label:"任务名称：",prop:"templateName"}},[e("el-input",{attrs:{placeholder:"请输入任务名称",disabled:t.disabledFlag,"show-word-limit":"",size:"small"},model:{value:t.ruleForm.templateName,callback:function(e){t.$set(t.ruleForm,"templateName",e)},expression:"ruleForm.templateName"}})],1),e("el-form-item",{attrs:{label:"应用名称：",prop:"appName"}},[e("el-select",{attrs:{filterable:"","allow-create":"",placeholder:"请选择",disabled:t.disabledFlag,size:"small"},model:{value:t.ruleForm.appName,callback:function(e){t.$set(t.ruleForm,"appName",e)},expression:"ruleForm.appName"}},t._l(t.appNameList,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1),e("span",{staticClass:"tips red"},[t._v("*应用jvm启动参数需要包括该应用标识，否则无法attach到正确进程上")])],1),e("el-form-item",{attrs:{label:"单接口采集量：",prop:"recordCount"}},[e("el-input-number",{attrs:{step:1,"step-strictly":!0,min:1,max:1e4,placeholder:"单接口采集流量条数，最大限制10000条",disabled:t.disabledFlag,size:"small"},model:{value:t.ruleForm.recordCount,callback:function(e){t.$set(t.ruleForm,"recordCount",e)},expression:"ruleForm.recordCount"}}),e("el-tooltip",{staticStyle:{"margin-left":"10px"},attrs:{placement:"right"}},[e("div",{staticClass:"tips-content text-tips-content",attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"rule-box"},[t._v("\n                  单接口采集量范围1-10000。\n                ")])]),e("i",{staticClass:"el-icon-question"})])],1),e("el-form-item",{attrs:{label:"任务执行时长(min)：",prop:"recordTaskDuration"}},[e("el-input-number",{attrs:{step:1,"step-strictly":!0,min:60,max:3600,placeholder:"请输入任务执行时长",disabled:t.disabledFlag,size:"small"},model:{value:t.ruleForm.recordTaskDuration,callback:function(e){t.$set(t.ruleForm,"recordTaskDuration",e)},expression:"ruleForm.recordTaskDuration"}}),e("el-tooltip",{staticStyle:{"margin-left":"10px"},attrs:{placement:"right"}},[e("div",{staticClass:"tips-content text-tips-content",attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"rule-box"},[t._v("\n                  单任务运行时长，当采集运行时间超过该值会自动停止采集任务。\n                ")])]),e("i",{staticClass:"el-icon-question"})])],1)],1)]),e("el-card",[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("h4",[t._v("流量采集配置")])]),e("div",[e("el-row",[e("h5",{staticStyle:{float:"left"}},[t._v("http接口")]),t.buttonFlag?e("el-button-group",{staticClass:"fr"},[e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(e){return t.addAll("http")}}},[t._v("全选")]),e("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(e){return t.delAll("http")}}},[t._v("全删")]),e("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-document-add"},on:{click:function(e){return t.deal("http",!0)}}},[t._v("新增")])],1):t._e()],1),e("el-table",{attrs:{data:t.ruleForm.httpRecordInterfaces,"header-cell-style":t.tableHeaderStyle,"cell-class-name":t.cellClassName,border:"",size:"small","max-height":"515"}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),e("el-table-column",{attrs:{label:"http uri",prop:"uri",align:"center","show-overflow-tooltip":"",formatter:t.formatTableTDBlank}}),e("el-table-column",{attrs:{label:"描述",prop:"desc",align:"center","show-overflow-tooltip":"",formatter:t.formatTableTDBlank}}),e("el-table-column",{attrs:{label:"采样率(采样率万分之N)",prop:"sampleRate",width:"200",align:"center","show-overflow-tooltip":"",formatter:t.formatTableTDBlank}}),t.buttonFlag?e("el-table-column",{attrs:{label:"操作",align:"center",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.deal("http",!1,a.$index,a.row)}}},[t._v("编辑")]),e("el-button",{staticClass:"red",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.del("http",a.$index)}}},[t._v("删除")])]}}],null,!1,1965441430)}):t._e()],1),e("br"),e("el-row",[e("h5",{staticStyle:{float:"left"}},[t._v("dubbo接口")]),t.buttonFlag?e("el-button-group",{staticClass:"fr"},[e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(e){return t.addAll("dubbo")}}},[t._v("全选")]),e("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(e){return t.delAll("dubbo")}}},[t._v("全删")]),e("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-document-add"},on:{click:function(e){return t.deal("dubbo",!0)}}},[t._v("新增")])],1):t._e()],1),e("el-table",{attrs:{data:t.ruleForm.dubboRecordInterfaces,"header-cell-style":t.tableHeaderStyle,"cell-class-name":t.cellClassName,border:"",size:"small","max-height":"515"}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),e("el-table-column",{attrs:{label:"接口名称",prop:"interfaceName",align:"center","show-overflow-tooltip":"",formatter:t.formatTableTDBlank}}),e("el-table-column",{attrs:{label:"接口方法",prop:"methodName",align:"center","show-overflow-tooltip":"",formatter:t.formatTableTDBlank}}),e("el-table-column",{attrs:{label:"描述",prop:"desc",align:"center","show-overflow-tooltip":"",formatter:t.formatTableTDBlank}}),e("el-table-column",{attrs:{label:"采样率(采样率万分之N)",prop:"sampleRate",width:"200",align:"center","show-overflow-tooltip":"",formatter:t.formatTableTDBlank}}),t.buttonFlag?e("el-table-column",{attrs:{label:"操作",align:"center",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.deal("dubbo",!1,a.$index,a.row)}}},[t._v("编辑")]),e("el-button",{staticClass:"red",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.del("dubbo",a.$index)}}},[t._v("删除")])]}}],null,!1,3359946870)}):t._e()],1),e("br"),e("el-row",[e("h5",{staticStyle:{float:"left"}},[t._v("java方法")]),t.buttonFlag?e("el-button-group",{staticClass:"fr"},[e("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(e){return t.delAll("java")}}},[t._v("全删")]),e("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-document-add"},on:{click:function(e){return t.deal("java",!0)}}},[t._v("新增")])],1):t._e()],1),e("el-table",{attrs:{data:this.ruleForm.javaRecordInterfaces,"header-cell-style":t.tableHeaderStyle,"cell-class-name":t.cellClassName,border:"",size:"small","max-height":"515"}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),e("el-table-column",{attrs:{label:"java类",prop:"classPattern",align:"center","show-overflow-tooltip":"",formatter:t.formatTableTDBlank}}),e("el-table-column",{attrs:{label:"java方法",prop:"methodPatterns",align:"center","show-overflow-tooltip":"",formatter:t.formatTableTDBlank}}),e("el-table-column",{attrs:{label:"描述",prop:"desc",align:"center","show-overflow-tooltip":"",formatter:t.formatTableTDBlank}}),e("el-table-column",{attrs:{label:"采样率(采样率万分之N)",prop:"sampleRate",width:"200",align:"center","show-overflow-tooltip":"",formatter:t.formatTableTDBlank}}),t.buttonFlag?e("el-table-column",{attrs:{label:"操作",align:"center",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.deal("java",!1,a.$index,a.row)}}},[t._v("编辑")]),e("el-button",{staticClass:"red",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.del("java",a.$index)}}},[t._v("删除")])]}}],null,!1,3387518742)}):t._e()],1)],1)]),e("el-card",[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("h4",{staticStyle:{display:"inline-block",marginRight:"10px"}},[t._v("高级选项")]),e("el-checkbox",{on:{change:function(e){return t.changeOption("statusOption",arguments[0])}},model:{value:t.advanceOptionCheckFlag,callback:function(e){t.advanceOptionCheckFlag=e},expression:"advanceOptionCheckFlag"}})],1),t.statusOption?e("el-form",{staticClass:"demo-form-inline"},[e("el-form-item",{attrs:{"label-width":"160px"}},[e("template",{slot:"label"},[e("el-checkbox",{staticClass:"chooseAll",staticStyle:{marginRight:"30px"},attrs:{disabled:t.disabledFlag},on:{change:t.chooseToggle},model:{value:t.chooseAll,callback:function(e){t.chooseAll=e},expression:"chooseAll"}}),e("el-tooltip",{attrs:{placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                  1、开启插件后，插件会自动拦截流量请求调用入参和出参情况"),e("br"),t._v("\n                  2、绿色代表入口插件，蓝色代表子调用插件\n                ")]),e("i",{staticClass:"el-icon-question"})]),t._v("\n              请选择插件：\n            ")],1),e("el-checkbox-group",{staticClass:"subInvocationPlugins",attrs:{disabled:t.disabledFlag},model:{value:t.ruleForm.subInvocationPlugins,callback:function(e){t.$set(t.ruleForm,"subInvocationPlugins",e)},expression:"ruleForm.subInvocationPlugins"}},[t._l(t.plugins,(function(a){return[e("el-checkbox",{key:a.name,class:{isGreen:("http"==a.name||"dubbo-provider"==a.name||"java-entrance"==a.name)&&t.pluginIsChecked(a.name)},attrs:{label:a.name}},[e("span",{class:{isGreen:"http"==a.name||"dubbo-provider"==a.name||"java-entrance"==a.name}},[t._v(t._s(a.name))])])]}))],2)],2),e("el-form-item",{attrs:{"label-width":"160px"}},[e("template",{slot:"label"},[e("el-tooltip",{attrs:{placement:"top",content:"sandbox日志会出输出到业务项目日志中心"}},[e("i",{staticClass:"el-icon-question"})]),t._v("\n              sandbox日志级别：\n            ")],1),e("el-select",{attrs:{placeholder:"请选择",size:"small",disabled:t.disabledFlag},model:{value:t.ruleForm.sandboxLogLevel,callback:function(e){t.$set(t.ruleForm,"sandboxLogLevel",e)},expression:"ruleForm.sandboxLogLevel"}},t._l(t.logOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],2),e("el-form-item",{attrs:{"label-width":"160px"}},[e("template",{slot:"label"},[e("el-tooltip",{attrs:{placement:"top",content:"repeater日志会出输出到业务项目日志中心"}},[e("i",{staticClass:"el-icon-question"})]),t._v("\n              repeater日志级别：\n            ")],1),e("el-select",{attrs:{placeholder:"请选择",size:"small",disabled:t.disabledFlag},model:{value:t.ruleForm.repeaterLogLevel,callback:function(e){t.$set(t.ruleForm,"repeaterLogLevel",e)},expression:"ruleForm.repeaterLogLevel"}},t._l(t.logOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],2)],1):t._e()],1)],1),e("el-card",{staticClass:"add-record-bottom-component"},[t.buttonFlag?e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.saveRecord("ruleForm")}}},[t._v("保存")]):t._e(),e("el-button",{attrs:{size:"small"},on:{click:function(e){return t.resetForm()}}},[t._v("关闭")])],1)],1),e("el-dialog",{attrs:{title:"http接口",visible:t.httpDialogFormVisible,width:"600px"},on:{"update:visible":function(e){t.httpDialogFormVisible=e}}},[e("el-form",{ref:"http",staticClass:"demo-ruleForm",attrs:{model:t.httpRuleForm,rules:t.httpRules,"label-width":"180px"}},[e("el-form-item",{attrs:{label:"http uri",prop:"uri"}},[e("el-input",{attrs:{size:"small"},model:{value:t.httpRuleForm.uri,callback:function(e){t.$set(t.httpRuleForm,"uri",e)},expression:"httpRuleForm.uri"}}),e("el-tooltip",{staticStyle:{"margin-left":"1%"},attrs:{placement:"top"}},[e("div",{staticClass:"tips-content text-tips-content",attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"rule-box"},[t._v("\n              请输入要采集的http uri列表"),e("br"),t._v("uri不需要包括域名并且不支持正则表达式\n            ")])]),e("i",{staticClass:"el-icon-question"})])],1),e("el-form-item",{attrs:{label:"描述",prop:"desc"}},[e("el-input",{attrs:{type:"textarea",rows:3},model:{value:t.httpRuleForm.desc,callback:function(e){t.$set(t.httpRuleForm,"desc",e)},expression:"httpRuleForm.desc"}})],1),e("el-form-item",{attrs:{label:"采样率(采样率万分之N)",prop:"sampleRate"}},[e("el-input-number",{attrs:{min:1,max:1e4,label:"1~10000",size:"small"},model:{value:t.httpRuleForm.sampleRate,callback:function(e){t.$set(t.httpRuleForm,"sampleRate",e)},expression:"httpRuleForm.sampleRate"}}),e("el-tooltip",{staticStyle:{"margin-left":"5px"},attrs:{placement:"top"}},[e("div",{staticClass:"tips-content text-tips-content",attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"rule-box"},[t._v("\n              采样率范围1-10000，10000代表全量采集\n            ")])]),e("i",{staticClass:"el-icon-question"})])],1)],1),e("div",{staticStyle:{"text-align":"right","margin-top":"3%"}},[e("el-button",{attrs:{size:"small"},on:{click:function(e){t.httpDialogFormVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.dialogConfirm("http")}}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"dubbo接口",visible:t.dubboDialogFormVisible,width:"600px"},on:{"update:visible":function(e){t.dubboDialogFormVisible=e}}},[e("el-form",{ref:"dubbo",staticClass:"demo-ruleForm",attrs:{model:t.dubboRuleForm,rules:t.dubboRules,"label-width":"180px"}},[e("el-form-item",{attrs:{label:"接口名称",prop:"interfaceName"}},[e("el-input",{attrs:{size:"small"},model:{value:t.dubboRuleForm.interfaceName,callback:function(e){t.$set(t.dubboRuleForm,"interfaceName",e)},expression:"dubboRuleForm.interfaceName"}}),e("el-tooltip",{staticStyle:{"margin-left":"5px"},attrs:{placement:"top"}},[e("div",{staticClass:"tips-content text-tips-content",attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"rule-box"},[t._v("\n              请输入要采集的dubbo接口名，支持正则表达式。"),e("br"),t._v("\n              采集某个具体接口：com.test.query.TestRecordApi、采集所有接口：.*\n            ")])]),e("i",{staticClass:"el-icon-question"})])],1),e("el-form-item",{attrs:{label:"接口方法",prop:"methodName"}},[e("el-input",{attrs:{size:"small"},model:{value:t.dubboRuleForm.methodName,callback:function(e){t.$set(t.dubboRuleForm,"methodName",e)},expression:"dubboRuleForm.methodName"}}),e("el-tooltip",{staticStyle:{"margin-left":"5px"},attrs:{placement:"top"}},[e("div",{staticClass:"tips-content text-tips-content",attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"rule-box"},[t._v("\n              请输入要采集的dubbo接口方法名，支持正则表达式。"),e("br"),t._v("\n              采集某个具体方法名：testRecord、采集所有方法：.*\n            ")])]),e("i",{staticClass:"el-icon-question"})])],1),e("el-form-item",{attrs:{label:"描述",prop:"desc"}},[e("el-input",{attrs:{type:"textarea",rows:3,size:"small"},model:{value:t.dubboRuleForm.desc,callback:function(e){t.$set(t.dubboRuleForm,"desc",e)},expression:"dubboRuleForm.desc"}})],1),e("el-form-item",{attrs:{label:"采样率(采样率万分之N)",prop:"sampleRate"}},[e("el-input-number",{attrs:{min:1,max:1e4,label:"1~10000",size:"small"},model:{value:t.dubboRuleForm.sampleRate,callback:function(e){t.$set(t.dubboRuleForm,"sampleRate",e)},expression:"dubboRuleForm.sampleRate"}}),e("el-tooltip",{staticStyle:{"margin-left":"5px"},attrs:{placement:"top"}},[e("div",{staticClass:"tips-content text-tips-content",attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"rule-box"},[t._v("\n              采样率范围1-10000，10000代表全量采集\n            ")])]),e("i",{staticClass:"el-icon-question"})])],1)],1),e("div",{staticStyle:{"text-align":"right","margin-top":"3%"}},[e("el-button",{attrs:{size:"mini"},on:{click:function(e){t.dubboDialogFormVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.dialogConfirm("dubbo")}}},[t._v("确 定")])],1)],1),e("el-dialog",{staticClass:"javaDialogFormVisible",attrs:{title:"java方法",visible:t.javaDialogFormVisible,width:"600px"},on:{"update:visible":function(e){t.javaDialogFormVisible=e}}},[e("el-form",{ref:"java",staticClass:"demo-ruleForm",attrs:{model:t.javaRuleForm,rules:t.javaRules,"label-width":"180px"}},[e("el-form-item",{attrs:{label:"java类",prop:"classPattern"}},[e("el-input",{attrs:{size:"small",placeholder:"com.test.TestClass"},model:{value:t.javaRuleForm.classPattern,callback:function(e){t.$set(t.javaRuleForm,"classPattern",e)},expression:"javaRuleForm.classPattern"}}),e("el-tooltip",{staticStyle:{"margin-left":"5px"},attrs:{placement:"top"}},[e("div",{staticClass:"tips-content text-tips-content",attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"rule-box"},[t._v("\n              请输入要采集的java类，例：com.test.TestClass\n            ")])]),e("i",{staticClass:"el-icon-question"})])],1),e("el-form-item",{attrs:{label:"java方法",prop:"methodPatterns"}},[e("el-input",{attrs:{size:"small",placeholder:"test1;test2;test3"},model:{value:t.javaRuleForm.methodPatterns,callback:function(e){t.$set(t.javaRuleForm,"methodPatterns",e)},expression:"javaRuleForm.methodPatterns"}}),e("el-tooltip",{staticStyle:{"margin-left":"5px"},attrs:{placement:"top"}},[e("div",{staticClass:"tips-content text-tips-content",attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"rule-box"},[t._v("\n              请输入要采集的java方法名，例：testRecord，目前仅支持无参、无返回值方法\n            ")])]),e("i",{staticClass:"el-icon-question"})])],1),e("el-form-item",{attrs:{label:"获取容器上下文的方法",prop:"obtainApplicationContextMethod"}},[e("el-input",{attrs:{size:"small",placeholder:"com.test.SpringUtils.getApplicationContext"},model:{value:t.javaRuleForm.obtainApplicationContextMethod,callback:function(e){t.$set(t.javaRuleForm,"obtainApplicationContextMethod",e)},expression:"javaRuleForm.obtainApplicationContextMethod"}})],1),e("el-form-item",{attrs:{label:"描述",prop:"desc"}},[e("el-input",{attrs:{type:"textarea",maxlength:"100",rows:3,size:"small"},model:{value:t.javaRuleForm.desc,callback:function(e){t.$set(t.javaRuleForm,"desc",e)},expression:"javaRuleForm.desc"}})],1),e("el-form-item",{attrs:{label:"采样率",prop:"sampleRate"}},[e("el-input-number",{attrs:{min:1,max:1e4,label:"1~10000",size:"small"},model:{value:t.javaRuleForm.sampleRate,callback:function(e){t.$set(t.javaRuleForm,"sampleRate",e)},expression:"javaRuleForm.sampleRate"}}),e("el-tooltip",{staticStyle:{"margin-left":"5px"},attrs:{placement:"top"}},[e("div",{staticClass:"tips-content text-tips-content",attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"rule-box"},[t._v("\n              采样率范围1-10000，10000代表全量采集\n            ")])]),e("i",{staticClass:"el-icon-question"})])],1)],1),e("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[e("el-button",{attrs:{size:"mini"},on:{click:function(e){t.javaDialogFormVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.dialogConfirm("java")}}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"提示",visible:t.addDialogVisible,width:"500px"},on:{"update:visible":function(e){t.addDialogVisible=e}}},[t._v("\n    请输入采样率：\n    "),e("el-input-number",{attrs:{min:1,max:1e4,step:1,"step-strictly":"",placeholder:"1~10000",size:"small"},model:{value:t.dialogSampleRate,callback:function(e){t.dialogSampleRate=e},expression:"dialogSampleRate"}}),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:function(e){t.addDialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.addAllConfirm}},[t._v("确 定")])],1)],1)],1)},o=[],s=(a("fc02"),a("4057"),a("3f5b"),a("566e"),a("1bc7"),a("246f"),a("0cdc"),a("f829")),i=(a("e7a7"),a("365c")),r={data:function(){return{loading:!1,appNameList:[],timeout:null,templateId:"",plugins:[],isAdd:!0,index:0,httpDialogFormVisible:!1,dubboDialogFormVisible:!1,javaDialogFormVisible:!1,type:"add",chooseAll:!0,ruleForm:{templateName:"",appName:"",recordCount:500,recordTaskDuration:60,httpRecordInterfaces:[],dubboRecordInterfaces:[],javaRecordInterfaces:[],rmqRecordInterfaces:[],subInvocationPlugins:[],sandboxLogLevel:"OFF",repeaterLogLevel:"OFF"},rules:{templateName:[{required:!0,message:"请输入任务名称",trigger:"blur"}],appName:[{required:!0,message:"请输入或选择应用名称",trigger:"blur"}],recordCount:[{required:!0,message:"请输入单接口采集量",trigger:"blur"}],recordTaskDuration:[{required:!0,message:"请输入任务执行时长",trigger:"blur"},{type:"number",message:"执行时长必须为数字值"}]},httpRuleForm:{uri:"",desc:"",sampleRate:""},httpRules:{uri:[{required:!0,message:"请输入http uri",trigger:"blur"}],desc:[{required:!0,message:"请输入描述",trigger:"blur"},{min:1,max:200,message:"长度在 200 个字符以内",trigger:"blur"}],sampleRate:[{required:!0,message:"请输入采样率",trigger:"blur"}]},dubboRuleForm:{interfaceName:"",methodName:"",desc:"",sampleRate:""},dubboRules:{interfaceName:[{required:!0,message:"请输入接口名称",trigger:"blur"},{min:1,max:350,message:"长度在 1 到 350 个字符",trigger:"blur"}],methodName:[{required:!0,message:"请输入接口方法",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}],desc:[{required:!0,message:"请输入描述",trigger:"blur"},{min:1,max:200,message:"长度在 200 个字符以内",trigger:"blur"}],sampleRate:[{required:!0,message:"请输入采样率",trigger:"blur"}]},javaRuleForm:{classPattern:"",methodPatterns:"",obtainApplicationContextMethod:"",desc:"",sampleRate:""},javaRules:{desc:[{required:!0,message:"请输入描述",trigger:"blur"},{min:1,max:200,message:"长度在 200 个字符以内",trigger:"blur"}],sampleRate:[{required:!0,message:"请输入采样率",trigger:"blur"}]},advanceOptionCheckFlag:!0,statusOption:!0,disabledFlag:!1,buttonFlag:!0,addType:"",addDialogVisible:!1,dialogSampleRate:void 0,logOptions:["TRACE","DEBUG","INFO","WARN","ERROR","FATAL","OFF"]}},computed:{pluginIsChecked:function(){return function(t){return this.ruleForm.subInvocationPlugins.some(function(e){return Object(s["a"])(this,this),e===t}.bind(this))}}},watch:{"ruleForm.subInvocationPlugins":{handler:function(t){this.chooseAll=t.length===this.plugins.length},immediate:!0}},mounted:function(){this.type=this.$route.params.type,this.id=this.$route.params.id,this.templateId=this.$route.params.templateId,this.getAppNameList(),this.getPlugins(),"detail"==this.type?(this.disabledDetail(),this.getDetail()):"edit"==this.type&&this.getDetail()},methods:{getAppNameList:function(){i["a"].record.getAppNameList().then(function(t){Object(s["a"])(this,this),"SUCCESS"===t.code?this.appNameList=t.data||[]:this.$message.error("获取应用名称选项失败:"+t.msg)}.bind(this))},getDetail:function(){this.loading=!0,i["a"].record.recordDetail({id:this.id}).then(function(t){if(Object(s["a"])(this,this),"SUCCESS"===t.code){this.ruleForm.appName=t.data.appName,this.ruleForm.templateName=t.data.templateName;var e=JSON.parse(t.data.templateConfig);this.ruleForm.recordCount=e.recordCount,this.ruleForm.recordTaskDuration=e.recordTaskDuration,this.ruleForm.httpRecordInterfaces=e.httpRecordInterfaces,this.ruleForm.dubboRecordInterfaces=e.dubboRecordInterfaces,this.ruleForm.javaRecordInterfaces=[],e.javaRecordInterfaces&&e.javaRecordInterfaces.length&&(e.javaRecordInterfaces.forEach(function(t){Object(s["a"])(this,this),t.methodPatterns=t.methodPatterns.join(";")}.bind(this)),this.ruleForm.javaRecordInterfaces=e.javaRecordInterfaces),this.ruleForm.subInvocationPlugins=e.subInvocationPlugins,this.ruleForm.sandboxLogLevel=e.sandboxLogLevel,this.ruleForm.repeaterLogLevel=e.repeaterLogLevel}else this.$message.error("获取录制任务详情失败:"+t.msg);this.loading=!1}.bind(this))},getPlugins:function(){i["a"].record.getPlugins().then(function(t){Object(s["a"])(this,this),"SUCCESS"===t.code?(this.plugins=t.data,"add"==this.type&&(this.ruleForm.subInvocationPlugins=t.data.map(function(t){if(Object(s["a"])(this,this),t.checked)return t.name}.bind(this)))):this.$message.error("获取录制任务详情失败:"+t.msg)}.bind(this))},addAll:function(t){this.addType=t,this.dialogSampleRate=void 0,this.addDialogVisible=!0},addAllConfirm:function(){if(!this.dialogSampleRate)return this.$message.warning("请输入采样率");this.ruleForm["".concat(this.addType,"RecordInterfaces")].forEach(function(t){Object(s["a"])(this,this),t.sampleRate=this.dialogSampleRate}.bind(this)),this.addDialogVisible=!1},delAll:function(t){this.$confirm("此操作将删除".concat(t,"接口表格中的所有配置, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s["a"])(this,this),this.ruleForm["".concat(t,"RecordInterfaces")]=[]}.bind(this)).catch(function(){Object(s["a"])(this,this),this.$message({type:"info",message:"已取消删除"})}.bind(this))},deal:function(t,e,a,l){this.isAdd=e,e?this["".concat(t,"RuleForm")]={}:(this.index=a,this["".concat(t,"RuleForm")]=JSON.parse(JSON.stringify(l))),this["".concat(t,"DialogFormVisible")]=!0,this.$nextTick(function(){Object(s["a"])(this,this),this.$refs[t].clearValidate()}.bind(this))},dialogConfirm:function(t){var e={http:{uri:this.httpRuleForm.uri.toString(),desc:this.httpRuleForm.desc,sampleRate:this.httpRuleForm.sampleRate},dubbo:{interfaceName:this.dubboRuleForm.interfaceName,methodName:this.dubboRuleForm.methodName,desc:this.dubboRuleForm.desc,sampleRate:this.dubboRuleForm.sampleRate},java:{classPattern:this.javaRuleForm.classPattern,methodPatterns:this.javaRuleForm.methodPatterns,obtainApplicationContextMethod:this.javaRuleForm.obtainApplicationContextMethod,desc:this.javaRuleForm.desc,sampleRate:this.javaRuleForm.sampleRate}};this.$refs[t].validate(function(a){if(Object(s["a"])(this,this),!a)return!1;this.isAdd?this.ruleForm["".concat(t,"RecordInterfaces")].push(e[t]):this.$set(this.ruleForm["".concat(t,"RecordInterfaces")],this.index,e[t]),this["".concat(t,"DialogFormVisible")]=!1}.bind(this))},del:function(t,e){this.ruleForm["".concat(t,"RecordInterfaces")].splice(e,1)},disabledDetail:function(){this.disabledFlag=!0,this.buttonFlag=!1},changeOption:function(t,e){this[t]=e},chooseToggle:function(t){this.ruleForm.subInvocationPlugins=t?JSON.parse(JSON.stringify(this.plugins)):[]},cellClassName:function(t){var e=t.row,a=t.column;if(!e.desc&&"desc"===a.property)return"noDesc"},saveRecord:function(t){this.$refs[t].validate(function(t){if(Object(s["a"])(this,this),!t)return!1;var e={appName:"moonbox"};e.templateName=this.ruleForm.templateName,e.appName=this.ruleForm.appName;var a={};if(a.dubboRecordInterfaces=this.ruleForm.dubboRecordInterfaces,a.httpRecordInterfaces=this.ruleForm.httpRecordInterfaces,this.ruleForm.javaRecordInterfaces&&this.ruleForm.javaRecordInterfaces.length&&this.ruleForm.javaRecordInterfaces.forEach(function(t){Object(s["a"])(this,this),t.methodPatterns=t.methodPatterns.split(";")}.bind(this)),a.javaRecordInterfaces=this.ruleForm.javaRecordInterfaces,0===a.dubboRecordInterfaces.length&&0===a.httpRecordInterfaces.length&&0===a.javaRecordInterfaces.length)return this.$message.warning("至少需要有一条入口流量采集配置");a.recordCount=this.ruleForm.recordCount,a.recordTaskDuration=this.ruleForm.recordTaskDuration,a.subInvocationPlugins=this.ruleForm.subInvocationPlugins,a.sandboxLogLevel=this.ruleForm.sandboxLogLevel,a.repeaterLogLevel=this.ruleForm.repeaterLogLevel,e.templateConfig=JSON.stringify(a),"add"==this.type?i["a"].record.addRecord(e).then(function(t){Object(s["a"])(this,this),"SUCCESS"===t.code?this.resetForm():this.$message.error("添加录制任务失败:"+t.msg)}.bind(this)):"edit"==this.type&&(e.id=this.id,i["a"].record.update(e).then(function(t){Object(s["a"])(this,this),"SUCCESS"===t.code?this.resetForm():this.$message.error("修改失败:"+t.msg)}.bind(this)))}.bind(this))},resetForm:function(){this.$store.dispatch("page/close",{tagName:this.$route.name,notNext:!0}),this.routerPush({name:"record",params:{},query:{}})}}},n=r,c=(a("1d14"),a("e607")),u=Object(c["a"])(n,l,o,!1,null,"56693e30",null);e["default"]=u.exports},de49:function(t,e,a){a("26df")&&"g"!=/./g.flags&&a("bb8b").f(RegExp.prototype,"flags",{configurable:!0,get:a("6bf8")})},ffbf:function(t,e,a){}}]);